import BlogPost from "../../../components/blog_post";
import Foo from "../../../components/Foo";

export const meta = {
  title: "React Native WebView files upload",
  date: "2018-05-18",
  tags: ["react native", "webview"],
  category: "mobile",
};

export default ({ children }) => <BlogPost meta={meta}>{children}</BlogPost>;

<Foo />

You might wonder why the hack would you want to upload files through a WebView in a mobile app. Let’s just say that your best friend really needs this.

Consider you have an HTML page, that contains a file upload input:

```html
<input type="file" />
```

We’ll have to tackle each platform individually, because the solutions differ between iOS and Android.

---

## Table of contents

## iOS

By default, when you use the WebView component provided by React Native and you load a url that contains a file input tag, iOS will respond to it by displaying a dialog that will allow you to:

- take a photo or video using the camera
- select a file from your device

<figure>
  <img src="/images/img1.png" alt="" />
</figure>

It also supports the [`accept`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-accept) attribute. If specified, it will allow users to upload only photos, only videos, or both, based on its value:

However, when you select one of the options, your app will crash if you didn’t specify any permissions.

### Enable permissions

All you need to do is to add the following keys in your Info.plist file, depending on your needs:

**Photo capture:**

```xml
<key>NSCameraUsageDescription</key>
<string>Take pictures for certain activities</string>
```

**Gallery selection:**

```xml
<key>NSPhotoLibraryUsageDescription</key>
<string>Select pictures for certain activities</string>
```

**Video recording:**

```xml
<key>NSMicrophoneUsageDescription</key>
<string>Need microphone access for recording videos</string>
```

That’s it. Easy peasy, Lemon Squeezy.

---

## Android

In contrast to iOS, Android won’t do anything when you tap on the file upload input, because the events are not handled in the built-in WebView component.

### Why is this feature not included in React Native?

There is a pretty old [pull request](https://github.com/facebook/react-native/pull/12807) to add this functionality in React Native, but from the looks of it, it not gonna get merged any time soon.

Long story short, Facebook doesn’t need this feature for their own products, so they don’t want to bloat React Native’s code base. Their recommendation is to build your own custom **WebView** component.

### What are the solutions?

There are a lot of attempts in this regard, but none of them include all the features that you can experience in iOS.

So, we had to build our own component, based on the efforts of the previously mentioned pioneers: [react-native-webview-android-file-upload](https://github.com/andreipfeiffer/react-native-webview-android-file-upload).

By default, when using the custom WebView mentioned earlier, it will open a dialog that allows photo capture, video recording and gallery selection.

<figure>
  <img src="/images/img2.png" alt="" />
</figure>

It will also read the accept attribute from the input element, if available, and allow users to upload only the specified file types. Currently, the following values are supported:

- <code>
    accept="<b>image/\*</b>"
  </code>
- <code>
    accept="<b>video/\*</b>"
  </code>
- <code>
    accept="<b>image/\*, video/\*</b>"
  </code>
